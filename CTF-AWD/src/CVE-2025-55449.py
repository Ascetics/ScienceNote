import jwt
from datetime import datetime, timedelta

WEBUI_SK='Advanced_System_for_Text'

def generate_jwt(username):
    payload = {
        "username": username,
        "exp": datetime.utcnow() + timedelta(days=7),
    }
    token = jwt.encode(payload, WEBUI_SK, algorithm="HS256")
    return token

if __name__=='__main__':
    token = generate_jwt('astrbot')
    print(token)

    # 注意时间，执行decode前把操作系统的时间改为有效的日期
    t = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzY1OTU5NTk2fQ.W0Mg3SVOfUonGgZDMk_nswAVCcYTlOVAM_0KIdFnKSc'
    m = jwt.decode(t, WEBUI_SK, algorithms='HS256')
    print(m) 
    # {'username': 'admin', 'exp': 1765959596}